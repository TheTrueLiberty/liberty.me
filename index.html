<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Liberty — Professional Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
:root{
    --bg:#0a0a0a;--card:rgba(18,18,28,0.88);--glass:rgba(28,28,45,0.55);
    --accent:#b91c3e;--accent-hover:#e0204b;--text:#ececf5;--text-light:#aaaaaa;--border:rgba(185,28,62,0.32);
}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'Inter',sans-serif;overflow-x:hidden;line-height:1.5;font-weight:400;position:relative;opacity:0;transition:opacity 1s;}
body.loaded{opacity:1;}

#myVideo{position:fixed;top:50%;left:50%;min-width:100%;min-height:100%;width:auto;height:auto;transform:translate(-50%,-50%);z-index:-2;object-fit:cover;opacity:.4;filter:brightness(.45) contrast(1.25);}
@media (max-width:768px){#myVideo{opacity:.25;}}

#preloader{position:fixed;inset:0;background:#0a0a0a;z-index:9999;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:40px;transition:opacity 1.2s;}
#preloader.hidden{opacity:0;visibility:hidden;pointer-events:none;}
.preloader-logo{width:120px;height:120px;background:var(--accent);border-radius:50%;position:relative;animation:p 2s infinite alternate,f 4s ease-in-out infinite;box-shadow:0 0 60px rgba(185,28,62,.8);}
.preloader-logo::before{content:'L';position:absolute;inset:0;color:#fff;font-size:68px;font-weight:900;display:flex;align-items:center;justify-content:center;}
@keyframes p{from{box-shadow:0 0 60px rgba(185,28,62,.8);}to{box-shadow:0 0 100px rgba(255,51,102,.9);}}
@keyframes f{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}

.progress-bar{width:280px;height:4px;background:rgba(255,255,255,.1);border-radius:2px;overflow:hidden;}
.progress-fill{width:0;height:100%;background:linear-gradient(90deg,#b91c3e,#ff3366);transition:width .4s;box-shadow:0 0 20px rgba(255,51,102,.8);}

.container{max-width:1320px;margin:0 auto;padding:80px 20px 140px;}
@media (max-width:768px){.container{padding:60px 16px 120px;}}

.card{background:var(--card);backdrop-filter:blur(22px);border:1px solid var(--border);border-radius:36px;padding:50px 30px;
    box-shadow:0 25px 70px rgba(0,0,0,.6), 0 0 25px rgba(185,28,62,.35);opacity:0;transform:translateY(70px);
    transition:all 1.4s cubic-bezier(.23,1,.32,1);}
.card.show{opacity:1;transform:none;}

.hero{display:flex;align-items:center;gap:40px;flex-wrap:wrap;position:relative;}
@media (max-width:992px){.hero{gap:32px;flex-direction:column;align-items:center;text-align:center;}}
.avatar{width:260px;height:260px;border-radius:32px;overflow:hidden;border:6px solid var(--accent);box-shadow:0 0 30px rgba(185,28,62,.6);flex-shrink:0;position:relative;z-index:1;}
@media (max-width:480px){.avatar{width:200px;height:200px;}}
.avatar img{width:100%;height:100%;object-fit:cover;}
.intro{flex:1;min-width:300px;}
h1{font-size:48px;line-height:1.1;margin-bottom:14px;color:#fff;}
.subtitle{font-size:18px;margin-bottom:36px;color:var(--text-light);opacity:.9;}
.stats{display:flex;gap:32px;flex-wrap:wrap;justify-content:center;margin:36px 0;}
.stat{font-size:32px;color:var(--accent);font-weight:800;}
.stat small{font-size:14px;margin-top:4px;color:var(--text-light);display:block;opacity:.9;}

.cta-wrapper{display:flex;flex-wrap:wrap;gap:20px;margin-top:44px;justify-content:center;}
.cta-btn{
    position:relative;display:flex;align-items:center;justify-content:center;gap:16px;
    padding:18px 36px;height:68px;border-radius:50px;
    background:linear-gradient(135deg,#b91c3e,#e0204b,#ff3366);color:#fff;font-size:19px;font-weight:700;
    box-shadow:0 16px 36px rgba(185,28,62,.4);cursor:pointer;transition:all .5s cubic-bezier(.23,1,.32,1);
    text-decoration:none;overflow:hidden;border:2px solid transparent;text-transform:uppercase;letter-spacing:.6px;
    min-width:300px;max-width:360px;width:100%;
}
.cta-btn img{width:36px;height:36px;filter:brightness(0) invert(1);}
@media (min-width:768px){.cta-btn{width:auto;min-width:340px;}}
.cta-btn::before{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,#ffffff44,transparent);transform:translateX(-100%);transition:.9s;}
.cta-btn:hover{transform:translateY(-8px) scale(1.04);box-shadow:0 24px 50px rgba(185,28,62,.6);border:2px solid #ff3366;}
.cta-btn:hover::before{transform:translateX(100%);}

.services h2{font-size:38px;margin:100px 0 50px;color:var(--accent);text-align:center;font-weight:800;}
.service-list{display:grid;gap:24px;grid-template-columns:1fr;}
@media (min-width:992px){.service-list{grid-template-columns:repeat(auto-fit,minmax(340px,1fr));}}
.service{background:var(--glass);backdrop-filter:blur(14px);border:1px solid var(--border);border-radius:20px;
    padding:28px;display:flex;flex-direction:column;gap:12px;transition:.5s;opacity:0;transform:translateY(30px);}
.service.show{opacity:1;transform:none;}
.service:hover{transform:translateY(-10px);border-color:var(--accent);}
.service strong{font-size:21px;color:var(--accent);font-weight:700;}
.service .desc{font-size:15px;color:var(--text-light);opacity:.92;}
.service .price{font-size:19px;color:var(--accent);font-weight:700;align-self:flex-end;}

.reviews-section{margin:160px 0 100px;overflow:hidden;}
.reviews-section h2{font-size:42px;background:linear-gradient(90deg,#b91c3e,#ff3366);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;text-align:center;margin-bottom:70px;font-weight:900;}
.reviews-grid-wrapper{position:relative;height:760px;overflow:hidden;}
.reviews-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:28px;padding:20px 0;animation:scrollGrid 40s linear infinite;will-change:transform;}
.reviews-grid.duplicate{animation:scrollGrid 40s linear infinite reverse;}
@media (min-width:1400px){.reviews-grid{grid-template-columns:repeat(4,1fr);}}
@media (max-width:992px){.reviews-grid{grid-template-columns:repeat(2,1fr);gap:20px;}}
@media (max-width:640px){.reviews-grid{grid-template-columns:1fr;}}
@keyframes scrollGrid{0%{transform:translateY(0)}100%{transform:translateY(-50%)}}
.review-card{background:rgba(28,28,40,.75);backdrop-filter:blur(20px);border:1px solid rgba(185,28,62,.3);border-radius:26px;padding:28px;box-shadow:0 16px 40px rgba(0,0,0,.5);transition:all .5s;height:340px;display:flex;flex-direction:column;}
.review-card:hover{transform:translateY(-12px) scale(1.03);border-color:var(--accent);box-shadow:0 24px 50px rgba(185,28,62,.3);}

#userPanel{position:fixed;top:20px;right:20px;display:flex;align-items:center;gap:12px;z-index:999;background:rgba(18,18,28,.95);padding:10px 16px;border-radius:20px;border:2px solid var(--accent);opacity:0;transition:.4s;pointer-events:none;}
#userPanel.show{opacity:1;pointer-events:auto;}
#userPanel img{width:42px;height:42px;border-radius:50%;border:3px solid var(--accent);object-fit:cover;}
#userPanel span{font-weight:700;color:#fff;}
#logoutBtn{margin-left:10px;color:#ff3366;cursor:pointer;font-size:14px;}

#authModal{position:fixed;inset:0;background:rgba(0,0,0,.96);display:flex;align-items:center;justify-content:center;z-index:10000;opacity:0;pointer-events:none;transition:.5s;}
#authModal.show{opacity:1;pointer-events:auto;}
.auth-content{background:var(--card);backdrop-filter:blur(24px);border:1px solid var(--border);border-radius:32px;width:100%;max-width:460px;padding:50px 40px;text-align:center;position:relative;}
.auth-content h2{color:var(--accent);font-size:36px;margin-bottom:30px;}
.auth-toggle{color:var(--text-light);margin-bottom:30px;font-size:14px;}
.auth-toggle span{cursor:pointer;color:var(--accent);text-decoration:underline;}
input[type=text],input[type=email],input[type=password]{
    width:100%;padding:16px 20px;margin:12px 0;background:rgba(255,255,255,.08);border:1px solid var(--border);border-radius:16px;color:#fff;font-size:16px;transition:.3s;
}
input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 20px rgba(185,28,62,.3);}
#closeAuth{position:absolute;top:20px;right:20px;background:var(--accent);width:40px;height:40px;border-radius:50%;color:#fff;font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.3s;}
#closeAuth:hover{background:var(--accent-hover);transform:scale(1.1);}

#music-player{
    position:fixed;bottom:30px;left:50%;transform:translateX(-50%);
    width:420px;max-width:calc(100% - 40px);background:rgba(20,20,35,.96);
    backdrop-filter:blur(32px);border:2px solid rgba(185,28,62,.4);border-radius:32px;
    padding:20px 28px;box-shadow:0 30px 80px rgba(0,0,0,.8),0 0 40px rgba(185,28,62,.4);
    z-index:999;opacity:0;transition:all .6s cubic-bezier(.23,1,.32,1);overflow:hidden;
}
#music-player.visible{opacity:1;}
#music-player .track-info{margin-bottom:12px;text-align:center;}
#music-player .track-title{font-size:18px;font-weight:800;color:#fff;}
#music-player .artist{font-size:14px;color:#bbb;margin-top:4px;}
.progress-container{display:flex;align-items:center;gap:12px;margin:16px 0;}
#songProgress{flex:1;height:8px;background:rgba(255,255,255,.12);border-radius:4px;overflow:hidden;position:relative;cursor:pointer;}
#songProgress .progress-fill{height:100%;width:0;background:linear-gradient(90deg,#b91c3e,#ff3366);box-shadow:0 0 20px rgba(255,51,102,.6);}
#songProgress .progress-knob{position:absolute;top:50%;right:0;width:18px;height:18px;background:var(--accent);border-radius:50%;transform:translate(50%,-50%);opacity:0;transition:all .2s;box-shadow:0 0 25px rgba(185,28,62,.9);}
#songProgress:hover .progress-knob{opacity:1;transform:translate(50%,-50%) scale(1.3);}
#currentTime,#duration{font-size:13px;color:#ccc;}
.controls{display:flex;align-items:center;justify-content:center;gap:24px;margin-top:8px;}
#play-pause-btn{width:64px;height:64px;background:var(--accent);border-radius:50%;display:flex;align-items:center;justify-content:center;
    cursor:pointer;transition:.4s;box-shadow:0 12px 40px rgba(185,28,62,.6);}
#play-pause-btn:hover{transform:scale(1.1);box-shadow:0 20px 60px rgba(185,28,62,.8);}
#play-pause-btn svg{width:28px;height:28px;fill:#fff;}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.96);display:flex;align-items:center;justify-content:center;
    opacity:0;pointer-events:none;transition:.5s;z-index:1000;padding:20px;}
.modal.show{opacity:1;pointer-events:auto;}
.modal-content{background:var(--card);backdrop-filter:blur(24px);border:1px solid var(--border);border-radius:28px;
    width:100%;max-width:540px;text-align:center;transform:scale(.92);transition:.5s;padding:50px 30px;position:relative;}
.modal.show .modal-content{transform:scale(1);}
.modal-close{
    position:absolute;top:20px;right:20px;width:40px;height:40px;background:var(--accent);border-radius:50%;
    color:#fff;font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.3s;
}
.modal-close:hover{background:var(--accent-hover);transform:scale(1.1);}

.contact-links a,.payment-methods > div{
    display:flex;align-items:center;gap:20px;background:rgba(185,28,62,.08);border:1px solid rgba(185,28,62,.2);
    border-radius:20px;padding:18px 24px;margin:14px 0;transition:.4s;font-weight:600;font-size:18px;color:var(--text);text-decoration:none;
}
.contact-links a:hover,.payment-methods > div:hover{
    background:rgba(185,28,62,.18);border-color:var(--accent);transform:translateY(-6px);
}
.contact-links img,.payment-methods img{width:36px;height:36px;border-radius:8px;flex-shrink:0;object-fit:cover;}

#reviewModal .modal-content{display:flex;flex-direction:column;gap:24px;align-items:center;}
#reviewText{width:100%;padding:18px;background:rgba(255,255,255,.08);border:1px solid var(--border);border-radius:20px;color:#fff;font-size:16px;resize:none;}
#reviewText:focus{outline:none;border-color:var(--accent);box-shadow:0 0 25px rgba(185,28,62,.3);}
#ratingInput{font-size:42px;letter-spacing:10px;cursor:pointer;transition:.3s;}
#ratingInput:hover{transform:scale(1.08);}
#submitReviewBtn{width:100%;max-width:380px;}

/* ИСПРАВЛЕННАЯ ПАНЕЛЬ ЯЗЫКА */
.lang-wrapper{position:fixed;top:20px;left:20px;z-index:9999;}
.lang-master{width:56px;height:56px;background:rgba(18,18,28,.95);border:3px solid var(--accent);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:19px;font-weight:900;cursor:pointer;box-shadow:0 8px 30px rgba(0,0,0,.6);transition:transform .3s;position:relative;z-index:2;}
.lang-master:hover{transform:scale(1.12);}
.lang-popup{position:absolute;top:70px;left:50%;transform:translateX(-50%);background:rgba(18,18,28,.98);border:2px solid var(--accent);border-radius:16px;overflow:hidden;display:none;min-width:80px;box-shadow:0 15px 40px rgba(0,0,0,.7);z-index:1;}
.lang-popup.active{display:block;animation:pop .3s ease-out;}
@keyframes pop{from{transform:translateX(-50%) scale(.9);opacity:0}to{transform:translateX(-50%) scale(1);opacity:1}}
.lang-btn{padding:14px 24px;color:#fff;cursor:pointer;transition:.3s;font-size:17px;text-align:center;}
.lang-btn:hover{background:var(--accent);}
</style>
</head>
<body>

<div id="preloader">
    <div class="preloader-logo"></div>
    <div class="preloader-text">LIBERTY</div>
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
</div>

<video autoplay muted loop playsinline id="myVideo">
    <source src="https://cdn.jsdelivr.net/gh/0x00A/0x00A@main/bg.mp4" type="video/mp4">
</video>

<audio id="background-music" loop preload="auto">
    <source src="https://cdn.jsdelivr.net/gh/0x00A/0x00A@main/exyl.mp3" type="audio/mpeg">
</audio>

<!-- ПАНЕЛЬ ЯЗЫКА -->
<div class="lang-wrapper">
    <div class="lang-master" id="langMaster">EN</div>
    <div class="lang-popup" id="langPopup">
        <div class="lang-btn" data-lang="en">EN</div>
        <div class="lang-btn" data-lang="ru">RU</div>
    </div>
</div>

<div id="userPanel">
    <img id="userAvatar" src="" alt="">
    <span id="userName">User</span>
    <span id="logoutBtn">Выйти</span>
</div>

<div class="container">
    <div class="card" id="mainCard">
        <div class="hero">
            <div class="avatar">
                <img src="assets/6ad1f8b10c7b2937f056040602fe6f0f.jpg" alt="Liberty">
            </div>
            <div class="intro">
                <h1 data-en="Welcome to my bio :P" data-ru="Ты попал в моё био :P">Welcome to my bio :P</h1>
                <div class="subtitle" data-en="Certified Cyber Security Analyst • Network Architect • Python Developer"
                     data-ru="Сертифицированный спец по кибербезу • Нетворкер • Python-дев">
                    Certified Cyber Security Analyst • Network Architect • Python Developer
                </div>
                <div class="stats">
                    <div class="stat">2+<small data-en="years experience" data-ru="года в деле">years experience</small></div>
                    <div class="stat">50+<small data-en="completed projects" data-ru="выполненных заказов">completed projects</small></div>
                </div>

                <div class="cta-wrapper">
                    <a href="javascript:void(0)" class="cta-btn" id="contactBtn">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/telegram.svg" alt="">
                        <span data-en="HIRE ME NOW" data-ru="ОФОРМИТЬ ЗАКАЗ">HIRE ME NOW</span>
                    </a>
                    <a href="javascript:void(0)" class="cta-btn" id="paymentBtn">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/bitcoin.svg" alt="">
                        <span data-en="Payment Options" data-ru="Способы оплаты">Payment Options</span>
                    </a>
                </div>
            </div>
        </div>

        <div class="services">
            <h2 data-en="SERVICES THAT I OFFER" data-ru="МОИ УСЛУГИ">SERVICES THAT I OFFER</h2>
            <div class="service-list">
                <div class="service"><div><strong data-en="[01] Logo / Banner creation" data-ru="[01] Лого / Баннеры">[01] Logo / Banner creation</strong><div class="desc" data-en="Premium branding & graphics" data-ru="Премиум брендинг и графика">Premium branding & graphics</div></div><div class="price">$10+</div></div>
                <div class="service"><div><strong data-en="[02] Website Creation" data-ru="[02] Создание сайтов">[02] Website Creation</strong><div class="desc" data-en="From landing page to full project" data-ru="От лендинга до крупного проекта">From landing page to full project</div></div><div class="price" data-en="From $100" data-ru="От $100">From $100</div></div>
                <div class="service"><div><strong data-en="[03] Networker assistance" data-ru="[03] Помощь с инет.подключениями и настройкой">[03] Networker assistance</strong><div class="desc" data-en="Setting up your host, answer on common questions and etc." data-ru="Настройка хостинга, ответы на вопросы и т.д.">Setting up your host, answer on common questions and etc.</div></div><div class="price" data-en="Depends on your needs" data-ru="В зависимости от потребностей">Depends on your needs</div></div>
                <div class="service"><div><strong data-en="[04] Python development" data-ru="[04] Разработка на Python">[04] Python development</strong><div class="desc" data-en="Creating a python project like discord bot or any sort of stuff" data-ru="Создание ботов в телеграме/дискорде,автоматизация процессов">Creating a python project like discord bot, parsers, automation</div></div><div class="price" data-en="Depends on how hard it is" data-ru="Зависит от сложности">Depends on how hard it is</div></div>
                <div class="service" data-en="[05] Livery creation"><div><strong>[05] Livery creation</strong><div class="desc">Creating detailed liveries for erlc in great quality.</div></div><div class="price">From $5</div></div>
            </div>
        </div>

        <div class="reviews-section">
            <h2 data-en="CLIENT REVIEWS" data-ru="ОТЗЫВЫ КЛИЕНТОВ">CLIENT REVIEWS</h2>
            <div class="reviews-grid-wrapper">
                <div class="reviews-grid" id="reviewsGrid"></div>
                <div class="reviews-grid duplicate" id="reviewsGridDuplicate"></div>
            </div>
            <div class="cta-wrapper" style="margin-top:60px;justify-content:center;">
                <a href="javascript:void(0)" class="cta-btn" id="leaveReviewBtn"><span data-en="LEAVE A REVIEW" data-ru="ОСТАВИТЬ ОТЗЫВ">LEAVE A REVIEW</span></a>
            </div>
        </div>
    </div>
</div>

<!-- МОДАЛЫ -->
<div id="authModal">
    <div class="auth-content">
        <button id="closeAuth">x</button>
        <h2 id="authTitle">Sign In</h2>
        <div class="auth-toggle">
            <span id="toggleToRegister">Create account</span> | <span id="toggleToLogin">Sign in</span>
        </div>
        <div id="emailAuthFields">
            <input type="text" id="displayName" placeholder="Your nickname" style="display:none;">
            <input type="email" id="email" placeholder="Email" required>
            <input type="password" id="password" placeholder="Password (6+ chars)" required>
            <button class="cta-btn" id="authSubmit">Continue</button>
        </div>
        <div style="margin:25px 0;color:#777;font-size:14px;">or</div>
        <button class="cta-btn" id="authGoogleBtn">
            <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/google.svg" style="filter:invert(1);width:28px;height:28px;margin-right:12px;">
            Continue with Google
        </button>
    </div>
</div>

<div id="music-player">
    <div class="track-info">
        <div class="track-title">Friday</div>
        <div class="artist">Riton x Nightcrawlers</div>
    </div>
    <div class="progress-container">
        <span id="currentTime">0:00</span>
        <div id="songProgress">
            <div class="progress-fill"></div>
            <div class="progress-knob"></div>
        </div>
        <span id="duration">--:--</span>
    </div>
    <div class="controls">
        <button id="play-pause-btn">
            <svg class="play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            <svg class="pause" viewBox="0 0 24 24" style="display:none"><path d="M6 4h4v16H6zM14 4h4v16h-4z"/></svg>
        </button>
    </div>
</div>

<div id="contactModal" class="modal">
    <div class="modal-content">
        <button class="modal-close">x</button>
        <h3 data-en="CONTACT" data-ru="КОНТАКТЫ">CONTACT</h3>
        <div class="contact-links">
            <a href="mailto:interpoldis@gmail.com"><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/gmail.svg" alt=""> interpoldis@gmail.com</a>
            <a href="https://t.me/TheTrueLiberty" target="_blank"><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/telegram.svg" alt=""> @TheTrueLiberty</a>
            <a href="https://discord.com/users/1084944590898937867" target="_blank"><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/discord.svg" alt=""> TheTrueLiberty</a>
        </div>
    </div>
</div>

<div id="paymentModal" class="modal">
    <div class="modal-content">
        <button class="modal-close">x</button>
        <h3 data-en="Payment Methods" data-ru="Способы оплаты">Payment Methods</h3>
        <div class="payment-methods">
            <div><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/ton.svg" alt=""> Tonkeeper</div>
            <div><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/tether.svg" alt=""> USDT TRC20</div>
            <div><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/bitcoin.svg" alt=""> Bitcoin</div>
            <div><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/telegram.svg" alt=""> @CryptoBot</div>
            <div><img src="https://cdn.jsdelivr.net/npm/simple-icons@v13/icons/mastercard.svg" alt=""> Bank transfers [EU]</div>
        </div>
        <p style="margin-top:28px;opacity:.85;" data-en="DM me for details" data-ru="Напиши — пришлю реквизиты">DM me for details</p>
    </div>
</div>

<div id="reviewModal" class="modal">
    <div class="modal-content">
        <button class="modal-close">x</button>
        <h3 data-en="Leave a review" data-ru="Оставить отзыв">Leave a review</h3>
        <textarea id="reviewText" data-en-placeholder="Your review..." data-ru-placeholder="Ваш отзыв..." maxlength="300" rows="5"></textarea>
        <div id="ratingInput">★★★★★</div>
        <button id="submitReviewBtn" class="cta-btn"><span data-en="Submit" data-ru="Отправить">Submit</span></button>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyDwsbb_tGMjr-s3NXmkkh1iEXkxKr9fDIQ",
    authDomain: "liberty-bio.firebaseapp.com",
    projectId: "liberty-bio",
    storageBucket: "liberty-bio.firebasestorage.app",
    messagingSenderId: "498591653250",
    appId: "1:498591653250:web:e634097c5fe0034212839b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentLang = 'en';
let currentUser = null;
let currentRating = 5;
let audioUnlocked = false;

// ЯЗЫК
const switchLang = () => {
    document.getElementById('langMaster').textContent = currentLang.toUpperCase();
    document.querySelectorAll('[data-en],[data-ru]').forEach(el => {
        const text = el.getAttribute(`data-${currentLang}`);
        if (text !== null) el.textContent = text;
    });
    const textarea = document.getElementById('reviewText');
    if (textarea) textarea.placeholder = textarea.getAttribute(`data-${currentLang}-placeholder`);
    document.querySelectorAll('.service').forEach((s, i) => {
        if (i === 4) s.style.display = currentLang === 'en' ? 'flex' : 'none';
    });
};

document.getElementById('langMaster').onclick = e => { e.stopPropagation(); document.getElementById('langPopup').classList.toggle('active'); };
document.addEventListener('click', e => { if (!e.target.closest('.lang-wrapper')) document.getElementById('langPopup').classList.remove('active'); });
document.querySelectorAll('.lang-btn').forEach(btn => btn.onclick = e => { e.stopPropagation(); currentLang = btn.dataset.lang; switchLang(); document.getElementById('langPopup').classList.remove('active'); });
switchLang();

// ПРЕЛОАДЕР
(() => {
    const preloader = document.getElementById('preloader');
    const fill = document.getElementById('progressFill');
    let p = 0;
    const t = setInterval(() => { p += Math.random()*7 + 4; if (p > 94) p = 94; fill.style.width = p + '%'; }, 80);
    Promise.all([document.fonts.ready, new Promise(r => window.addEventListener('load', r))]).then(() => {
        clearInterval(t); fill.style.width = '100%';
        setTimeout(() => {
            preloader.classList.add('hidden');
            document.body.classList.add('loaded');
            document.getElementById('mainCard').classList.add('show');
            document.querySelectorAll('.service').forEach((s,i) => setTimeout(() => s.classList.add('show'), 600 + i*150));
        }, 500);
    });
    setTimeout(() => { preloader.classList.add('hidden'); document.body.classList.add('loaded'); }, 5500);
})();

// АУДИО + ВИДЕО
const audio = document.getElementById('background-music');
const unlockAudio = () => { if (audioUnlocked) return; audio.play().catch(()=>{}); document.getElementById('myVideo').play().catch(()=>{}); audioUnlocked = true; document.removeEventListener('click', unlockAudio); document.removeEventListener('touchstart', unlockAudio); };
document.addEventListener('click', unlockAudio, {once: true});
document.addEventListener('touchstart', unlockAudio, {once: true});

const playPauseBtn = document.getElementById('play-pause-btn');
const playIcon = playPauseBtn.querySelector('.play');
const pauseIcon = playPauseBtn.querySelector('.pause');
playPauseBtn.addEventListener('click', () => {
    if (audio.paused) { audio.play(); playIcon.style.display = 'none'; pauseIcon.style.display = 'block'; }
    else { audio.pause(); playIcon.style.display = 'block'; pauseIcon.style.display = 'none'; }
});
setTimeout(() => document.getElementById('music-player').classList.add('visible'), 1800);

// АВТОРИЗАЦИЯ
const authModal = document.getElementById('authModal');
let isRegister = false;
document.getElementById('toggleToRegister').onclick = () => { isRegister = true; document.getElementById('authTitle').textContent = currentLang === 'ru' ? 'Регистрация' : 'Create Account'; document.getElementById('displayName').style.display = 'block'; };
document.getElementById('toggleToLogin').onclick = () => { isRegister = false; document.getElementById('authTitle').textContent = currentLang === 'ru' ? 'Вход' : 'Sign In'; document.getElementById('displayName').style.display = 'none'; };
document.getElementById('leaveReviewBtn').onclick = () => { if (!currentUser) authModal.classList.add('show'); else document.getElementById('reviewModal').classList.add('show'); };
document.getElementById('closeAuth').onclick = () => authModal.classList.remove('show');
authModal.onclick = e => e.target === authModal && authModal.classList.remove('show');

document.getElementById('authGoogleBtn').onclick = async () => { const p = new GoogleAuthProvider(); await signInWithPopup(auth, p); };
document.getElementById('authSubmit').onclick = async () => {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const displayName = document.getElementById('displayName').value.trim();
    if (!email || !password || (isRegister && !displayName)) return alert(currentLang === 'ru' ? 'Заполни все поля!' : 'Fill all fields!');
    try {
        let userCred = isRegister 
            ? await createUserWithEmailAndPassword(auth, email, password).then(u => { updateProfile(u.user, {displayName}); return u; })
            : await signInWithEmailAndPassword(auth, email, password);
        authModal.classList.remove('show');
    } catch (err) { alert(err.message); }
};

onAuthStateChanged(auth, user => {
    currentUser = user;
    if (user) {
        document.getElementById('userAvatar').src = user.photoURL || 'https://via.placeholder.com/64';
        document.getElementById('userName').textContent = user.displayName || user.email.split('@')[0];
        document.getElementById('userPanel').classList.add('show');
    } else {
        document.getElementById('userPanel').classList.remove('show');
    }
});
document.getElementById('logoutBtn').onclick = () => signOut(auth);

// ОТЗЫВЫ (ИСПРАВЛЕНО — правильный язык)
const reviewsGrid = document.getElementById('reviewsGrid');
const reviewsGridDupe = document.getElementById('reviewsGridDuplicate');

function renderReviews(snap) {
    const reviews = [];
    snap.forEach(d => reviews.push({id: d.id, ...d.data()}));

    reviewsGrid.innerHTML = reviewsGridDupe.innerHTML = '';

    if (reviews.length === 0) {
        const msg = currentLang === 'ru' ? 'Пока нет отзывов :(' : 'No reviews yet :(';
        const beFirst = currentLang === 'ru' ? 'Будь первым!' : 'Be the first!';
        const ph = `<div class="review-card"><div style="text-align:center;padding:100px 20px;color:#777;font-size:18px;">${msg}<br><br>${beFirst}</div></div>`;
        reviewsGrid.innerHTML = reviewsGridDupe.innerHTML = ph.repeat(12);
        return;
    }

    while (reviews.length < 24) reviews.push(...reviews);
    reviews.length = 24;

    const frag1 = document.createDocumentFragment();
    const frag2 = document.createDocumentFragment();

    reviews.forEach(r => {
        const reviewText = currentLang === 'ru' 
            ? (r.text_ru || r.text || 'Отличная работа!') 
            : (r.text_en || r.text || 'Great job!');

        const card = document.createElement('div');
        card.className = 'review-card';
        card.innerHTML = `
            <div style="display:flex;align-items:center;gap:16px;margin-bottom:16px;">
                <img src="${r.photoURL || 'https://via.placeholder.com/64'}" style="width:64px;height:64px;border-radius:50%;border:4px solid #b91c3e;object-fit:cover;">
                <div>
                    <div style="font-weight:700;color:#fff;font-size:17px;">${r.name || 'Anonymous'}</div>
                    <div style="font-size:13px;color:#aaa;">${r.timestamp?.toDate?.()?.toLocaleDateString() || ''}</div>
                </div>
            </div>
            <div style="display:flex;gap:6px;font-size:30px;color:#b91c3e;margin:8px 0;">
                ${'★'.repeat(r.rating || 5)}${'☆'.repeat(5 - (r.rating || 5))}
            </div>
            <div style="color:#ddd;line-height:1.6;font-size:15px;flex:1;overflow:hidden;">
                ${reviewText.replace(/\n/g, '<br>')}
            </div>
        `;
        frag1.appendChild(card);
        frag2.appendChild(card.cloneNode(true));
    });

    reviewsGrid.appendChild(frag1);
    reviewsGridDupe.appendChild(frag2);
}

const q = query(collection(db, "reviews"), orderBy("timestamp", "desc"));
onSnapshot(q, renderReviews);

// ОТПРАВКА ОТЗЫВА (сохраняет на нужном языке)
document.getElementById('ratingInput').onclick = e => {
    const rect = e.currentTarget.getBoundingClientRect();
    const x = e.clientX - rect.left;
    currentRating = Math.ceil((x / rect.width) * 5);
    e.currentTarget.innerHTML = '★'.repeat(currentRating) + '☆'.repeat(5-currentRating);
};

document.getElementById('submitReviewBtn').onclick = async () => {
    if (!currentUser) return alert(currentLang === 'ru' ? 'Войди сначала!' : 'Log in first!');
    const textInput = document.getElementById('reviewText').value.trim();
    if (!textInput) return alert(currentLang === 'ru' ? 'Напиши отзыв!' : 'Write a review!');

    const field = currentLang === 'ru' ? 'text_ru' : 'text_en';

    await addDoc(collection(db, "reviews"), {
        name: currentUser.displayName || currentUser.email.split('@')[0],
        photoURL: currentUser.photoURL || 'https://via.placeholder.com/64',
        text: textInput,
        [field]: textInput,
        rating: currentRating,
        timestamp: serverTimestamp()
    });

    alert(currentLang === 'ru' ? 'Спасибо!' : 'Thank you!');
    document.getElementById('reviewModal').classList.remove('show');
    document.getElementById('reviewText').value = '';
    currentRating = 5;
    document.getElementById('ratingInput').innerHTML = '★★★★★';
};

// МОДАЛКИ
document.getElementById('contactBtn').onclick = () => document.getElementById('contactModal').classList.add('show');
document.getElementById('paymentBtn').onclick = () => document.getElementById('paymentModal').classList.add('show');
document.querySelectorAll('.modal-close').forEach(btn => btn.onclick = () => btn.closest('.modal').classList.remove('show'));
document.querySelectorAll('.modal').forEach(m => m.onclick = e => e.target === m && m.classList.remove('show'));
</script>
</body>
</html>
